<meta http-equiv="content-type" content="text/html; charset=utf-8" />

<!DOCTYPE html>
<html>
<head>
<title><%= yield(:title) %></title>
  <% 
    # Load CSS from both app/assets/builds (development) and public/assets (production/staging)
    css = ''
    candidates = []
    
    # Add CSS from app/assets/builds (development)
    candidates.concat(Dir.glob(Rails.root.join('app', 'assets', 'builds', '*.css').to_s))
    
    # Add CSS from public/assets (production/staging with fingerprinted names)
    candidates.concat(Dir.glob(Rails.root.join('public', 'assets', 'application-*.css').to_s))
    
    # Read and combine all CSS files
    css = candidates.filter_map do |path|
      begin
        File.read(path)
      rescue => e
        Rails.logger.warn "Could not read compiled CSS from #{path}: #{e.message}"
        nil
      end
    end.join("\n")
    
    Rails.logger.warn "No CSS files found for PDF generation" if css.blank?
  %>
  <style type="text/css">
    <%= css.html_safe %>
  </style>
</head>
<body>
  <%= yield %>
</body>
</html>
